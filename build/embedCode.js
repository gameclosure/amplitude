// https://github.com/amplitude/Amplitude-Javascript

(function(window,document){var log=function(e){console.log("[Amplitude] "+e)};var isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};var queryString=function(e){var t=[];for(var n in e){var r=e[n];if(isArray(r)){for(var i=0;i<r.length;i++){t.push(encodeURIComponent(n)+"="+encodeURIComponent(r[i]))}}else{t.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}}return t.join("&")};var UUID=function(){var e=[];for(var t=0;t<32;t++){e[t]=Math.floor(Math.random()*16).toString(16)}var n=e.join("");return n};var localStorage;if(window.localStorage){localStorage=window.localStorage}else if(window.globalStorage){try{localStorage=window.globalStorage[window.location.hostname]}catch(e){}}else{var div=document.createElement("div"),attrKey="localStorage";div.style.display="none";document.getElementsByTagName("head")[0].appendChild(div);if(div.addBehavior){div.addBehavior("#default#userdata");localStorage={length:0,setItem:function(e,t){div.load(attrKey);if(!div.getAttribute(e)){this.length++}div.setAttribute(e,t);div.save(attrKey)},getItem:function(e){div.load(attrKey);return div.getAttribute(e)},removeItem:function(e){div.load(attrKey);if(div.getAttribute(e)){this.length--}div.removeAttribute(e);div.save(attrKey)},clear:function(){div.load(attrKey);var e=0;var t;while(t=div.XMLDocument.documentElement.attributes[e++]){div.removeAttribute(t.name)}div.save(attrKey);this.length=0},key:function(e){div.load(attrKey);return div.XMLDocument.documentElement.attributes[e]}};div.load(attrKey);localStorage.length=div.XMLDocument.documentElement.attributes.length}else{}}if(!localStorage){localStorage={length:0,setItem:function(e,t){},getItem:function(e){},removeItem:function(e){},clear:function(){},key:function(e){}}}var UTF8={encode:function(e){e=e.replace(/\r\n/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r)}else if(r>127&&r<2048){t+=String.fromCharCode(r>>6|192);t+=String.fromCharCode(r&63|128)}else{t+=String.fromCharCode(r>>12|224);t+=String.fromCharCode(r>>6&63|128);t+=String.fromCharCode(r&63|128)}}return t},decode:function(e){var t="";var n=0;var r=0,i=0,o=0;while(n<e.length){r=e.charCodeAt(n);if(r<128){t+=String.fromCharCode(r);n++}else if(r>191&&r<224){i=e.charCodeAt(n+1);t+=String.fromCharCode((r&31)<<6|i&63);n+=2}else{i=e.charCodeAt(n+1);o=e.charCodeAt(n+2);t+=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63);n+=3}}return t}};var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){try{if(window.btoa&&window.atob){return window.btoa(unescape(encodeURIComponent(e)))}}catch(t){}return Base64._encode(e)},_encode:function(e){var t="";var n,r,i,o,a,s,u;var d=0;e=UTF8.encode(e);while(d<e.length){n=e.charCodeAt(d++);r=e.charCodeAt(d++);i=e.charCodeAt(d++);o=n>>2;a=(n&3)<<4|r>>4;s=(r&15)<<2|i>>6;u=i&63;if(isNaN(r)){s=u=64}else if(isNaN(i)){u=64}t=t+Base64._keyStr.charAt(o)+Base64._keyStr.charAt(a)+Base64._keyStr.charAt(s)+Base64._keyStr.charAt(u)}return t},decode:function(e){try{if(window.btoa&&window.atob){return decodeURIComponent(escape(window.atob(e)))}}catch(t){}return Base64._decode(e)},_decode:function(e){var t="";var n,r,i;var o,a,s,u;var d=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(d<e.length){o=Base64._keyStr.indexOf(e.charAt(d++));a=Base64._keyStr.indexOf(e.charAt(d++));s=Base64._keyStr.indexOf(e.charAt(d++));u=Base64._keyStr.indexOf(e.charAt(d++));n=o<<2|a>>4;r=(a&15)<<4|s>>2;i=(s&3)<<6|u;t=t+String.fromCharCode(n);if(s!=64){t=t+String.fromCharCode(r)}if(u!=64){t=t+String.fromCharCode(i)}}t=UTF8.decode(t);return t}};var JSON=window.JSON;if(typeof JSON!=="object"){JSON={}}(function(){"use strict";function f(e){return e<10?"0"+e:e}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(e){escapable.lastIndex=0;return escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t==="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,o,a=gap,s,u=t[e];if(u&&typeof u==="object"&&typeof u.toJSON==="function"){u=u.toJSON(e)}if(typeof rep==="function"){u=rep.call(t,e,u)}switch(typeof u){case"string":return quote(u);case"number":return isFinite(u)?String(u):"null";case"boolean":case"null":return String(u);case"object":if(!u){return"null"}gap+=indent;s=[];if(Object.prototype.toString.apply(u)==="[object Array]"){o=u.length;for(n=0;n<o;n+=1){s[n]=str(n,u)||"null"}i=s.length===0?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+a+"]":"["+s.join(",")+"]";gap=a;return i}if(rep&&typeof rep==="object"){o=rep.length;for(n=0;n<o;n+=1){if(typeof rep[n]==="string"){r=rep[n];i=str(r,u);if(i){s.push(quote(r)+(gap?": ":":")+i)}}}}else{for(r in u){if(Object.prototype.hasOwnProperty.call(u,r)){i=str(r,u);if(i){s.push(quote(r)+(gap?": ":":")+i)}}}}i=s.length===0?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+a+"}":"{"+s.join(",")+"}";gap=a;return i}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(e,t,n){var r;gap="";indent="";if(typeof n==="number"){for(r=0;r<n;r+=1){indent+=" "}}else if(typeof n==="string"){indent=n}rep=t;if(t&&typeof t!=="function"&&(typeof t!=="object"||typeof t.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":e})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(e,t){var n,r,i=e[t];if(i&&typeof i==="object"){for(n in i){if(Object.prototype.hasOwnProperty.call(i,n)){r=walk(i,n);if(r!==undefined){i[n]=r}else{delete i[n]}}}}return reviver.call(e,t,i)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}})();var userAgent=navigator.userAgent;var vendor=navigator.vendor;var platform=navigator.platform;var BrowserDetect={init:function(){this.browser=this.searchString(this.dataBrowser)||null;this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||null;this.OS=this.searchString(this.dataOS)||null},searchString:function(e){for(var t=0;t<e.length;t++){var n=e[t].string;var r=e[t].prop;this.versionSearchString=e[t].versionSearch||e[t].identity;if(n){if(n.indexOf(e[t].subString)!=-1){return e[t].identity}}else if(r){return e[t].identity}}},searchVersion:function(e){var t=e.indexOf(this.versionSearchString);if(t==-1){return}return parseFloat(e.substring(t+this.versionSearchString.length+1))},dataBrowser:[{string:userAgent,subString:"Chrome",identity:"Chrome"},{string:userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:vendor,subString:"iCab",identity:"iCab"},{string:vendor,subString:"KDE",identity:"Konqueror"},{string:userAgent,subString:"Firefox",identity:"Firefox"},{string:vendor,subString:"Camino",identity:"Camino"},{string:userAgent,subString:"Netscape",identity:"Netscape"},{string:userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:platform,subString:"Win",identity:"Windows"},{string:platform,subString:"Mac",identity:"Mac"},{string:userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:userAgent,subString:"Android",identity:"Android"},{string:platform,subString:"Linux",identity:"Linux"}]};BrowserDetect.init();var Request=function(e,t){this.url=e;this.data=t||{}};Request.prototype.send=function(e){var t=window.XDomainRequest?true:false;if(t){var n=new window.XDomainRequest;n.open("POST",this.url,true);n.onload=function(){e(n.responseText)};n.send(queryString(this.data))}else{var r=new XMLHttpRequest;r.open("POST",this.url,true);r.onreadystatechange=function(){if(r.readyState==4){if(r.status==200){e(r.responseText)}}};r.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");r.send(queryString(this.data))}};var Cookie={get:function(e){var t=e+"=";var n=document.cookie.split(";");for(var r=0;r<n.length;r++){var i=n[r];while(i.charAt(0)==" "){i=i.substring(1,i.length)}if(i.indexOf(t)==0){return i.substring(t.length,i.length)}}return null},set:function(e,t,n){if(n){var r=new Date;r.setTime(r.getTime()+n*24*60*60*1e3);var i="; expires="+r.toGMTString()}else{var i=""}document.cookie=e+"="+t+i+"; path=/"},remove:function(e){Cookie.set(e,"",-1)}};var Amplitude=function(){};var options={apiEndpoint:"api.amplitude.com",cookieName:"amplitude_id",cookieExpiration:365*10,unsentKey:"amplitude_unsent",saveEvents:true};var eventId=0;var unsentEvents=[];var sending=false;var nextEventId=function(){eventId++;return eventId};Amplitude.prototype.init=function(e,t,n){try{this.options=options;options.apiKey=e;if(n){if(n.saveEvents!==undefined){options.saveEvents=!!n.saveEvents}}var r=Cookie.get(options.cookieName);var i=null;if(r){try{i=JSON.parse(Base64.decode(r));if(i){if(i.deviceId){options.deviceId=i.deviceId}if(i.userId){options.userId=i.userId}if(i.globalUserProperties){options.globalUserProperties=i.globalUserProperties}}}catch(o){}}options.deviceId=options.deviceId||UUID();options.userId=t!==undefined&&t!==null&&t||options.userId||null;saveCookieData();eventId=0;if(options.saveEvents){var a=localStorage.getItem(options.unsentKey);if(a){try{unsentEvents=JSON.parse(a)}catch(o){}}}if(unsentEvents.length>0){this.sendEvents()}}catch(o){log(o)}};var saveCookieData=function(){Cookie.set(options.cookieName,Base64.encode(JSON.stringify({deviceId:options.deviceId,userId:options.userId,globalUserProperties:options.globalUserProperties})),options.cookieExpiration)};var saveEvents=function(){try{localStorage.setItem(options.unsentKey,JSON.stringify(unsentEvents))}catch(e){}};Amplitude.prototype.setUserId=function(e){try{options.userId=e!==undefined&&e!==null&&""+e||null;saveCookieData()}catch(t){log(t)}};Amplitude.prototype.setGlobalUserProperties=function(e){try{options.globalUserProperties=e;saveCookieData()}catch(t){log(t)}};Amplitude.prototype.setVersionName=function(e){try{options.versionName=e}catch(t){log(t)}};Amplitude.prototype.logEvent=function(e,t){try{var n=(new Date).getTime();t=t||{};var r={device_id:options.deviceId,user_id:options.userId||options.deviceId,timestamp:n,event_id:nextEventId(),session_id:-1,event_type:e,client:BrowserDetect.browser,version_code:0,version_name:options.versionName||null,build_version_sdk:0,build_version_release:BrowserDetect.version,phone_model:BrowserDetect.OS,custom_properties:t,global_properties:options.globalUserProperties||{}};unsentEvents.push(r);if(options.saveEvents){saveEvents()}this.sendEvents()}catch(i){log(i)}};Amplitude.prototype.sendEvents=function(){if(!sending){sending=true;var e=("https:"==window.location.protocol?"https":"http")+"://"+options.apiEndpoint+"/";var t={client:options.apiKey,e:JSON.stringify(unsentEvents)};var n=unsentEvents.length;var r=this;new Request(e,t).send(function(e){sending=false;try{if(JSON.parse(e).added==n){unsentEvents.splice(0,n);if(options.saveEvents){saveEvents()}if(unsentEvents.length>0){r.sendEvents()}}}catch(t){}})}};var old=window.amplitude||{};var q=old._q||[];var instance=new Amplitude;window.amplitude=instance;for(var i=0;i<q.length;i++){var fn=instance[q[i][0]];fn&&fn.apply(instance,q[i].slice(1))}})(window,document);

;(function(){var c=CONFIG.addons.amplitude;if(c.apiKey){amplitude.init(c.apiKey);amplitude.logEvent("PAGE_LOAD_START");var s=0;__amplitude={start:Date.now(),timer:setInterval(function(){s+=2;amplitude.logEvent("PAGE_LOADING_"+s)},2000)}}})();
